{
  "name": "At-Risk Customers",
  "category": "Customer Segmentation",
  "description": "This segment identifies customers who are showing signs of disengagement and are at a higher risk of churning.",
  "insights": "These customers require proactive re-engagement strategies to prevent churn. Understanding the reasons for their inactivity is crucial for improving retention. Targeted incentives or personalized outreach could be effective.\n\nHere's a summary of the insights:\n\n*   **Definition of At-Risk:** Customers who have not made a purchase in over 305 days and have made 4 or fewer total orders are considered at-risk.\n*   **Distribution of At-Risk Customers by Order Count:**\n    *   1 total order: 59 customers\n    *   2 total orders: 72 customers\n    *   3 total orders: 101 customers\n    *   4 total orders: 96 customers\n*   **Highest Risk Group:** The largest group of at-risk customers are those who have made 3 total orders (101 customers), followed closely by those with 4 total orders (96 customers).\n*   **Business Implications:** These customers are showing signs of disengagement and are at a higher risk of churning. Proactive re-engagement strategies are crucial to prevent them from becoming completely inactive.\n*   **Recommendations:**\n    *   **Targeted Re-engagement Campaigns:** Develop specific campaigns for these segments, perhaps with different messaging or offers based on their number of past orders.\n    *   **Understand Inactivity:** Investigate the reasons behind their inactivity. This could involve surveys, feedback requests, or analyzing their last purchase behavior.\n    *   **Personalized Incentives:** Offer personalized incentives (e.g., discounts on preferred categories, exclusive access to new products) to entice them back.\n    *   **Customer Service Outreach:** For the highest-value customers within this at-risk group, consider personalized outreach from customer service to understand their needs and offer assistance.\n\nThis data highlights specific segments of at-risk customers, allowing for more targeted and effective retention efforts.",
  "query": "SELECT total_number_of_orders, COUNT(customer_id) as customer_count FROM `customer_data_retail.customers` WHERE DATE_DIFF(CURRENT_DATE(), PARSE_DATE('%Y-%m-%d', SUBSTR(CAST(date_of_last_purchase AS STRING), 1, 10)), DAY) > 305 AND total_number_of_orders <= 4 GROUP BY total_number_of_orders ORDER BY total_number_of_orders",
  "visualization": {
    "type": "bar",
    "x_axis": "total_number_of_orders",
    "y_axis": "customer_count",
    "tooltip": ["total_number_of_orders", "customer_count"]
  }
}